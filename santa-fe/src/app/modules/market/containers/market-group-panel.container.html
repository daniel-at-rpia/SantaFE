<article [ngClass]="{
  'sat-marketGroupPanel': true, 
  'sat-marketGroupPanel--configuratorCollapsedState': state.isConfiguratorCollapsed,
  'sat-marketGroupPanel--averageVisualizerEnabledState': state.utility.selectedWidget === 'AVERAGE_VISUALIZER',
  'sat-marketGroupPanel--pieConfiguratorEnabledState': state.utility.selectedWidget === 'PIE_CONFIGURATOR',
  'sat-marketGroupPanel--searchInProgressState': this.state.configurator.state.isLoading,
  'sat-marketGroupPanel--searchCompletedState': this.state.isGroupDataLoaded
}">
  <section class="sat-marketGroupPanel__configurator">
    <security-group-definition-configurator
      (onClickSearch)="onClickSearchInConfigurator($event)"
      [configuratorData]="state.configurator"
    ></security-group-definition-configurator>
  </section>
  <section class="sat-marketGroupPanel__configuratorCollapseCTA">
    <button
      (click)="onToggleCollapseConfigurator()"
      [ngClass]="{
        'sat-marketGroupPanel__configuratorCollapseCTA-btn': true,
        'fal': true,
        'fa-chevron-left': !state.isConfiguratorCollapsed,
        'fa-chevron-right': state.isConfiguratorCollapsed
      }"></button>
    <div class="sat-marketGroupPanel__configuratorCollapseCTA-line"></div>
  </section>
  <section class="sat-marketGroupPanel__groups">
    <div class="sat-marketGroupPanel__groups-utility">
      <div class="sat-marketGroupPanel__groups-utility-prompt">
        <span class="sat-marketGroupPanel__groups-utility-prompt-highlightText">{{state.securityGroupList.length}}</span>
        <span class="sat-marketGroupPanel__groups-utility-prompt-text">groups matched your search</span>
      </div>
      <div class="sat-marketGroupPanel__groups-utility-widgetSelector">
        <div class="sat-marketGroupPanel__groups-utility-widgetSelector-btnGroup santaBtnGroup">
          <button
            (click)="onSwitchWidget('AVERAGE_VISUALIZER')"
            [ngClass]="{
              'sat-marketGroupPanel__groups-utility-widgetSelector-btnGroup-btn': true,
              'santaBtn--labelled': true,
              'sat-marketGroupPanel__groups-utility-widgetSelector-btnGroup-btn--selected': state.utility.selectedWidget === 'AVERAGE_VISUALIZER',
              'santaBtn--inverseLabelled': state.utility.selectedWidget === 'AVERAGE_VISUALIZER'
            }">
            <i class="fas fa-calculator"></i>
            <span>Average Calculator</span>
          </button>
          <button
            (click)="onSwitchWidget('PIE_CONFIGURATOR')"
            [ngClass]="{
              'sat-marketGroupPanel__groups-utility-widgetSelector-btnGroup-btn': true,
              'santaBtn--labelled': true,
              'sat-marketGroupPanel__groups-utility-widgetSelector-btnGroup-btn--selected': state.utility.selectedWidget === 'PIE_CONFIGURATOR',
              'santaBtn--inverseLabelled': state.utility.selectedWidget === 'PIE_CONFIGURATOR'
            }">
            <i class="fas fa-chart-pie"></i>
            <span>Pie Configurator</span>
          </button>
        </div>
      </div>
      <div class="sat-marketGroupPanel__groups-utility-pieConfigurator">
        <div class="sat-marketGroupPanel__groups-utility-pieConfigurator-leftPie"></div>
        <div class="sat-marketGroupPanel__groups-utility-pieConfigurator-rightPie"></div>
      </div>
      <div class="sat-marketGroupPanel__groups-utility-groupAverage">
        <security-group-average-visualizer
          [visualizerData]="state.visualizer"
          (onMetricChange)="updateGroupStats()">
        </security-group-average-visualizer>
      </div>
    </div>
    <ul class="sat-marketGroupPanel__groups-list">
      <li *ngFor="let eachGroup of state.securityGroupList; let i = index" class="sat-marketGroupPanel__groups-list-item">
        <security-group
          [groupData]="eachGroup"
          [isDataReady]="!eachGroup.state.isStencil"></security-group>
      </li>
    </ul>
  </section>
</article>