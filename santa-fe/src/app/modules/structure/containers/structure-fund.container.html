<article [ngClass]="{
  'sat-fundStructuring': true,
  'sat-fundStructuring--editAvailableState': fund.state.isEditAvailable && !fund.state.isViewingHistoricalData,
  'sat-fundStructuring--editingState': fund.state.isEditingFund,
  'sat-fundStructuring--invalidInput': fund.state.hasErrors.updatedCreditDuration || fund.state.hasErrors.updatedCreditLeverage,
  'sat-fundStructuring--errorState': fund.state.isDataUnavailable,
  'sat-fundStructuring--autoScalingAvailableState': fund.state.autoScalingAvailable,
  'sat-fundStructuring--autoScalingSelectedState': fund.state.autoScalingActive,
  'sat-fundStructuring--isViewingIndex': !fund.data.activeDelta,
  'sat-fundStructuring--creditLeverageDeltaSignificantPositive': fund.data.currentTotalDeltaCreditLeverageSignificantPositive,
  'sat-fundStructuring--creditLeverageDeltaSignificantNegative': fund.data.currentTotalDeltaCreditLeverageSignificantNegative,
  'sat-fundStructuring--creditDurationDeltaSignificantPositive': fund.data.currentTotalDeltaCreditDurationSignificantPositive,
  'sat-fundStructuring--creditDurationDeltaSignificantNegative': fund.data.currentTotalDeltaCreditDurationSignificantNegative,
  'sat-fundStructuring--isDisplayCs01': activeMetric === this.constants.cs01,
  'sat-fundStructuring--isDisplayCreditLeverage': activeMetric === this.constants.creditLeverage
  }">
  <header *ngIf="fund.data" class="sat-fundStructuring__configuration">
    <div class="sat-fundStructuring__configuration-metric">
      <target-bar [targetBar]="fund.data.creditLeverageTargetBar">
      </target-bar>
      <div class="sat-fundStructuring__configuration-metric-data">
        <div class="sat-fundStructuring__configuration-metric-data-index">
          <target-bar [targetBar]="fund.data.creditLeverageIndexBar"></target-bar>
        </div>
        <div class="sat-fundStructuring__configuration-metric-data-creditLeverageDelta">
          <div class="sat-fundStructuring__configuration-metric-data-creditLeverageDelta-text">
            <span class="sat-fundStructuring__configuration-metric-data-creditLeverageDelta-text-type">{{ fund.data.activeDeltaDisplayText }}</span>
            <i class="fal fa-triangle sat-fundStructuring__configuration-metric-data-creditLeverageDelta-text-icon"></i>
            <span class="sat-fundStructuring__configuration-metric-data-creditLeverageDelta-text-type">: </span>
            <span class="sat-fundStructuring__configuration-metric-data-creditLeverageDelta-text-difference">{{ fund.data.currentTotalDeltaCreditLeverageDisplayText }}</span>
          </div>
        </div>
      </div>
    </div>
    <h2 class="sat-fundStructuring__configuration-title">{{ fund.data.portfolioShortName }}</h2>
    <div class="sat-fundStructuring__configuration-metric">
      <target-bar [targetBar]="fund.data.creditDurationTargetBar"></target-bar>
      <div class="sat-fundStructuring__configuration-metric-data">
        <div class="sat-fundStructuring__configuration-metric-data-index">
          <target-bar [targetBar]="fund.data.creditDurationIndexBar"></target-bar>
        </div>
        <div class="sat-fundStructuring__configuration-metric-data-creditDurationDelta">
          <div class="sat-fundStructuring__configuration-metric-data-creditDurationDelta-text">
            <span class="sat-fundStructuring__configuration-metric-data-creditDurationDelta-text-type">{{ fund.data.activeDeltaDisplayText }}</span>
            <i class="fal fa-triangle sat-fundStructuring__configuration-metric-data-creditDurationDelta-text-icon"></i>
            <span class="sat-fundStructuring__configuration-metric-data-creditDurationDelta-text-type">: </span>
            <span class="sat-fundStructuring__configuration-metric-data-creditDurationDelta-text-difference">{{ fund.data.currentTotalDeltaCreditDurationDisplayText }}</span>
          </div>
        </div>
      </div>
    </div>
  </header>
  <section *ngIf="fund.data" class="sat-fundStructuring__editFund">
    <i class="sat-fundStructuring__editFund-backgroundIcon fal fa-pencil"></i>
    <div class="sat-fundStructuring__editFund-addOverrides">
      <button (click)="onClickedAddCustomBreakdown()" class="sat-fundStructuring__editFund-addOverrides-overrideCta santaBtn--labelled santaBtn--inverseLabelled">
        <i class="fal fa-plus"></i>
        <span>Add Override</span>
      </button>
      <button (click)="onClickedAddBulkOverrides()" class="sat-fundStructuring__editFund-addOverrides-bulkOverrideCta santaBtn--labelled santaBtn--inverseLabelled">
        <i class="fal fa-plus"></i>
        <span>Add Overrides To All Funds</span>
      </button>
    </div>
    <span class="sat-fundStructuring__editFund-message">{{ fund.state.hasErrors.errorMessage }}</span>
    <div class="sat-fundStructuring__editFund-group">
      <santa-input
        [inputValue]="fund.data.target.target.creditDuration"
        [placeholder]="''"
        [label]="'Target Credit Duration'"
        [inverseColored]="true"
        (onInputChange)="onChangeValue($event, constants.creditDuration)"
        [hasError]="fund.state.hasErrors.updatedCreditDuration"
        class="sat-fundStructuring__editFund-group-input">
      </santa-input>
    </div>
    <div class="sat-fundStructuring__editFund-group">
      <santa-input
        [inputValue]="fund.data.target.target.creditLeverage"
        [placeholder]="''"
        [label]="'Target Credit Leverage'"
        [inverseColored]="true"
        (onInputChange)="onChangeValue($event, constants.creditLeverage)"
        [hasError]="fund.state.hasErrors.updatedCreditLeverage"
        class="sat-fundStructuring__editFund-group-input">
      </santa-input>
    </div>
    <button (click)="onToggleEditTargetAutoScaling()" class="santaBtn--labelled sat-fundStructuring__editFund-autoScalingToggle">
      <i
        [ngClass]="{
          'fal': true,
          'fa-square': !fund.state.autoScalingActive,
          'fa-check-square': fund.state.autoScalingActive
        }">
      </i>
      <span>Auto-Adjust Breakdown Targets</span>
    </button>
  </section>
  <section class="sat-fundStructuring__utility">
    <div class="sat-fundStructuring__utility-btnGroup">
      <button class="sat-fundStructuring__utility-btnGroup-btn santaBtn--circleLabelled sat-fundStructuring__utility-btnGroup-btn--cancel" (click)="closeEditMenu()">
        <i class="fal fa-times"></i>
        <span>Cancel Edit</span>
      </button>
      <button class="sat-fundStructuring__utility-btnGroup-btn santaBtn--circleLabelled sat-fundStructuring__utility-btnGroup-btn--edit" (click)="showEditMenu()">
        <i class="fal fa-pencil"></i>
        <span>Edit Fund</span>
      </button>
      <button class="sat-fundStructuring__utility-btnGroup-btn santaBtn--circleLabelled sat-fundStructuring__utility-btnGroup-btn--save"
      (click)="onClickSaveNewMetrics(fund.state.modifiedFundTargets.creditDuration, fund.state.modifiedFundTargets.creditLeverage)">
        <i class="fal fa-check"></i>
        <span>Save Edit</span>
      </button>
    </div>
    <hr class="sat-fundStructuring__utility-divider">
  </section>
  <section *ngIf="fund.data" class="sat-fundStructuring__content">
    <ul class="sat-fundStructuring__content-breakdownList">
      <li class="sat-fundStructuring__content-breakdownList-item" *ngFor="let eachBreakdown of fund.data.displayChildren">
        <portfolio-breakdown
          [breakdownData]="eachBreakdown"
          [dataIsReady]="!fund.state.isStencil"
          (clickedEdit)="onClickedEditInBreakdown($event)">
        </portfolio-breakdown>
      </li>
      <p class="sat-fundStructuring__content-errorMessage">No available portfolio data to show</p>
    </ul>
  </section>
</article>